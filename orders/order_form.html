<!DOCTYPE html>
<html>
<head>
    <title>Создание заказа</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .form-container { max-width: 800px; margin: 30px auto; padding: 20px; }
        .item-form { border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 5px; }
        .form-control { margin-bottom: 10px; }
    </style>
</head>
<body>
    <div class="form-container">
        <h2>Создание заказа</h2>

        <form method="post" id="order-form">
            {% csrf_token %}

            <div class="mb-3">
                <label for="id_customer" class="form-label">Клиент:</label>
                {{ form.customer }}
            </div>

            <h3>Товары в заказе</h3>
            <div id="items-container">
                <!-- Формы товаров будут здесь -->
                <div class="item-form">
                    <div class="mb-3">
                        <label class="form-label">Товар:</label>
                        <select name="items-0-product" class="form-control">
                            {% for product in products %}
                                <option value="{{ product.id }}">{{ product.name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Количество:</label>
                        <input type="number" name="items-0-quantity" min="1" value="1" class="form-control">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Скидка (%):</label>
                        <input type="number" name="items-0-discount_percent" min="0" max="100" step="0.1" value="0" class="form-control">
                    </div>
                </div>
            </div>

            <button type="button" id="add-item" class="btn btn-secondary mb-3">+ Добавить товар</button>
            <button type="submit" class="btn btn-primary">Сохранить заказ</button>
        </form>
    </div>

    <!-- Подключаем jQuery для удобной работы с DOM -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
    $(document).ready(function() {
        let itemCount = 1;

        // Обработчик кнопки "Добавить товар"
        $('#add-item').click(function() {
            const newForm = `
                <div class="item-form">
                    <div class="mb-3">
                        <label class="form-label">Товар:</label>
                        <select name="items-${itemCount}-product" class="form-control">
                            {% for product in products %}
                                <option value="{{ product.id }}">{{ product.name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Количество:</label>
                        <input type="number" name="items-${itemCount}-quantity" min="1" value="1" class="form-control">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Скидка (%):</label>
                        <input type="number" name="items-${itemCount}-discount_percent" min="0" max="100" step="0.1" value="0" class="form-control">
                    </div>
                </div>`;

            $('#items-container').append(newForm);
            itemCount++;
        });
    });
    </script>
</body>
</html>